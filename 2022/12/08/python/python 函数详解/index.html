<!DOCTYPE html>
<html>
  <head>
     
    <meta charset="UTF-8">
    <title>python 函数详解 - onepiece</title>
    <link rel="shortcut icon" href="/static/img/icon.png">
    <link rel="icon" href="/static/img/icon.png" sizes="192x192"/>
    
<link rel="stylesheet" href="/static/kico.css">
<link rel="stylesheet" href="/static/hingle.css">

    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <meta name="viewport" content="width=device-width, maximum-scale=1, initial-scale=1"/>
    <meta property="og:site_name" content="onepiece">
    <meta property="og:title" content="python 函数详解"/>
    
    <style>body:before{ content: ''; background-image: url(https://github.com/junliangl/hexo-back/blob/master/images/images/%E6%9D%8F%E6%9E%9D.jpg?raw=true) }</style>
    
<meta name="generator" content="Hexo 6.3.0"></head>

  <body class="dark-theme">
    <header>
    <div class="head-title">
        <h4>onepiece</h4>
    </div>
    <div class="head-action">
        <div class="toggle-btn"></div>
        <div class="light-btn"></div>
        <div class="search-btn"></div>
    </div>
    <form class="head-search" method="post">
        <input type="text" name="s" placeholder="暂时不支持搜索哦">
    </form>
    <nav class="head-menu">
        <a href="/">首页</a>
        <div class="has-child">
            <a>分类</a>
            <div class="sub-menu">
				<a href="/categories/python/">python</a>
				<a href="/categories/linux">linux</a>
				<a href="/categories/test">测试</a>
            </div>
        </div>
        
            <a href="/about">关于我</a>
        
    </nav>
</header>

    <main>
    <div class="wrap min">
        <section class="post-title">
            <h2>python 函数详解</h2>
            <div class="post-meta">
                <time class="date">2022.12.08</time>
            
                <span class="category"><a class="category-link" href="/categories/python/">python</a></span>
            
            </div>
        </section>
        <article class="post-content">
        
            <h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>以下有关变量的作用域和类相关的请参考</p>
<ul>
<li><a href="/2022/12/08/python/python%20%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F/" title="python 变量的作用域">python 变量的作用域</a></li>
<li><a href="/2022/12/10/python/python%20%E5%86%85%E5%AD%98%E8%AF%A6%E8%A7%A3/" title="python 内存详解">python 内存详解</a></li>
<li><a href="/2022/12/10/python/python%20%E7%B1%BB%E8%AF%A6%E8%A7%A3/" title="python 类详解">python 类详解</a></li>
</ul>
<h1 id="函数命名规则"><a href="#函数命名规则" class="headerlink" title="函数命名规则"></a>函数命名规则</h1><p>小写开头，多个单词下划线 _ 隔开</p>
<ul>
<li><p><code>hello()，test_()， _good_time()</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test_</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_good_time</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="对于类里的函数命名规则"><a href="#对于类里的函数命名规则" class="headerlink" title="对于类里的函数命名规则"></a>对于类里的函数命名规则</h2><p>对于类里的方法命名有以下规则</p>
<ul>
<li><p>python 预先自定义的<code>__init__()，__str__()</code>等收尾双下划线的方法名称为魔法函数。并且一般不建议自己这样命名方法如<code>__public__()</code>因为会被误解为魔法函数。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Test类&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__public__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>__private()</code>以双下划线开头但是不以双下划线结尾的称为私有函数，只能在类里面调用</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__private</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test = Test()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        test.__private()</span><br><span class="line">    <span class="keyword">except</span> AttributeError <span class="keyword">as</span> a:</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/1.png"></p>
</li>
</ul>
<h3 id="特殊情况"><a href="#特殊情况" class="headerlink" title="特殊情况"></a>特殊情况</h3><p>然而可以通过<code>_Test__private()</code>强制访问</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__private</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test = Test()</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">dir</span>(test))</span><br><span class="line">    <span class="built_in">print</span>(test._Test__private())</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/2.png"></p>
<p>以上我们可以看到 test 属性有一个 <code>_Test__private</code>，这意味着可以用它取访问私有的属性。python 其实没有正在意义上的私有属性，只不过我们希望它不能被外界访问时，加入这样的标识符使得被 python 识别。python 不支持私有属性,但当属性命名为 __ 时,会将属性改名为_类名__属性名.这个方法其实是变量名压缩( mangling ,相当于扩张)的概念,只是通过这种方法变相地实现了属性访问控制的功能。但是呢这个方法也很有用,尤其在多重继承,或者大项目的情况下,各个类及实例可能出现属性冲突的情况,就可以通过这个功能来实现。</p>
<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/renyiforever/article/details/79921854">https://blog.csdn.net/renyiforever/article/details/79921854</a></li>
</ul>
<h1 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h1><h2 id="参考链接-1"><a href="#参考链接-1" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1k7411W78H?p=6&amp;vd_source=f9937d98d0a8cc08ef5248c3c127d588">https://www.bilibili.com/video/BV1k7411W78H?p=6&amp;vd_source=f9937d98d0a8cc08ef5248c3c127d588</a></li>
</ul>
<h2 id="参数类别"><a href="#参数类别" class="headerlink" title="参数类别"></a>参数类别</h2><p>总所周知，写在函数名括号后的叫形式参数，简称形参；实际传值的参数叫实际参数，简称实参</p>
<h3 id="位置参数"><a href="#位置参数" class="headerlink" title="位置参数"></a>位置参数</h3><p>位置参数设定好以后位置传参不能随意发生改变。若随意改变，函数的功能会发生变化。并且传参参数量一定要匹配，多了或者少了会报错。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2, arg3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    test(<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        test(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError <span class="keyword">as</span> t:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        test(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError <span class="keyword">as</span> t:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/3.png"></p>
<ul>
<li><p>参数位置发生改变，方法功能性发生了改变。第一个输出的是 1，2，3；第二个输出的是 3，2，1</p>
</li>
<li><p>参数数量出现问题会抛出错误提示缺少一个位置参数和给多给了位置参数</p>
</li>
</ul>
<h3 id="关键字参数"><a href="#关键字参数" class="headerlink" title="关键字参数"></a>关键字参数</h3><p>位置参数固然稳定，但是 python 对于方法参数的数量没有做定量要求(java 一般要求参数数量不多于6个)，那么对于多位置参数这种方式会容易位置混乱容易照成方法功能性不符合预期</p>
<p>对于以上问题 python 给出解决方案为 关键字参数</p>
<p>使用方法是：针对形参名在传实参时可以指定想要传入给哪个形参，受指定的参数不受位置问题从而影响方法的功能性</p>
<p>但是一样要满足参数数量的严格吻合，否则还是会报错。并且不能对相同的关键字参数多次传值</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2, arg3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    test(arg3=<span class="number">3</span>, arg2=<span class="number">2</span>, arg1=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/4.png"></p>
<ul>
<li>以上不难看出关键字参数的使用具有指定性功能。这样即时位置混乱只要符合以上要求都能保持方法功能的正常使用</li>
</ul>
<h3 id="位置参数和关键字参数混搭"><a href="#位置参数和关键字参数混搭" class="headerlink" title="位置参数和关键字参数混搭"></a>位置参数和关键字参数混搭</h3><p>混搭规则是一定是实参传递时位置参数在前，关键字参数在后，否则会报错（铁律）</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2, arg3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, <span class="number">2</span>, arg3=<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    test(<span class="number">1</span>, arg2=<span class="number">2</span>, arg3=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/5.png"></p>
<ul>
<li><p>若实参传递时关键字参数放在位置参数之前，则编译会报错</p>
<p><img src="/./images/python/method/6.png"></p>
<p>以上报错信息提示位置参数在关键字参数之后了。</p>
</li>
<li><p>即使满足位置参数在前，关键字参数在后依旧会报错，位置参数还应该对应本身位置</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2, arg3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span> , <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        test(<span class="number">10</span>, <span class="number">30</span>, arg2=<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError <span class="keyword">as</span> t:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/7.png"></p>
<ul>
<li>以上不难看出，arg1，arg2 位置参数都已经给出了参数，但是随后的关键字参数再次给位置参数 arg2 传值，所以提示 test() 方法传给了 arg2 多个值的错误</li>
</ul>
</li>
</ul>
<h3 id="强制关键字参数"><a href="#强制关键字参数" class="headerlink" title="强制关键字参数"></a>强制关键字参数</h3><p>为了让位置参数不容易写混淆而照成方法功能性错误，从而引入强制关键字参数</p>
<p>用法是在需要使用强制关键字参数之前写入 * 号，代表 * 后的参数强制只能使用关键字参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def test(*, arg1, arg2, arg3):</span><br><span class="line">    print(f&quot;第一个参数是:&#123;arg1&#125;&quot;)</span><br><span class="line">    print(&quot;---------------------&quot;)</span><br><span class="line">    print(f&quot;第二个参数是:&#123;arg2&#125;&quot;)</span><br><span class="line">    print(&quot;---------------------&quot;)</span><br><span class="line">    print(f&quot;第三个参数是:&#123;arg3&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    test(arg1=1, arg2=2, arg3=3)</span><br><span class="line">    print(&quot;**********************&quot;)</span><br><span class="line">    try:</span><br><span class="line">        test(1, 2, arg3=3)</span><br><span class="line">    except TypeError as t:</span><br><span class="line">        print(t)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/8.png"></p>
<ul>
<li><p>以上不难看出 * 后实参的传递必须是关键字参数形式，如果没有按这样的方式，就会报 <code>TypeError</code>—test() 方法是0个位置参数，但是传递了2个位置参数</p>
</li>
<li><p>值得注意的是 * 号前依旧可以使用位置参数和关键字参数混搭，但是这建立在形参的 * 号位置</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2, *, arg3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, arg2=<span class="number">2</span>, arg3=<span class="number">3</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        test(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError <span class="keyword">as</span> t:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/9.png"></p>
<p>以上不难看出可以通过改变 * 号位置灵活使用强制关键字参数，但是依旧要遵守相关的混搭规则。</p>
</li>
</ul>
<h3 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a>默认参数</h3><p>在定义形参的时候，我们可以默认给其中的参数传递初始值(默认值)，这样依旧可以正常的定义参数</p>
<p>关键字参数的用法是：在传递实参的时候你可以给默认参数传递一个新的值，也可以不传递</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1=<span class="number">1</span>, arg2=<span class="number">2</span>, arg3=<span class="number">3</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    test(<span class="number">10</span>, arg2=<span class="number">20</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/10.png"></p>
<ul>
<li>以上不难看出可以不用给默认参数传值，也可以给其中的默认参数传值。传值可以使用位置参数和关键字参数混搭的模式，但是依旧要遵守混搭规则。</li>
</ul>
<h3 id="默认参数的混搭"><a href="#默认参数的混搭" class="headerlink" title="默认参数的混搭"></a>默认参数的混搭</h3><p>默认参数依旧可以和之前的位置参数和关键字参数以及强制关键字参数混搭</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def test(arg1, arg2, arg3, arg4=4):</span><br><span class="line">    print(f&quot;第一个参数是:&#123;arg1&#125;&quot;)</span><br><span class="line">    print(&quot;---------------------&quot;)</span><br><span class="line">    print(f&quot;第二个参数是:&#123;arg2&#125;&quot;)</span><br><span class="line">    print(&quot;---------------------&quot;)</span><br><span class="line">    print(f&quot;第三个参数是:&#123;arg3&#125;&quot;)</span><br><span class="line">    print(&quot;---------------------&quot;)</span><br><span class="line">    print(f&quot;第四个参数是:&#123;arg4&#125;&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    test(1, arg2=2, arg3=3, arg4=40)</span><br><span class="line">    print(&quot;**********************&quot;)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/11.png"></p>
<ul>
<li>以上不难看出默认参数混搭时依旧要遵守之前的混搭规则</li>
</ul>
<p>还有一点值得注意的是定义默认参数形参的时候一定要把所有的非默认参数在默认参数之前定义，否则编译不通过（除非形参包含强制关键字参数或可变参数，请参考下面可变位置参数）</p>
<p><img src="/./images/python/method/12.png"></p>
<p>这很好理解，因为如果定义在非默认参数之前，当传递实参的时候，编译器不知道你是否给默认参数传递了值，这样为了避免二义性直接编译阶段报错</p>
<p>当默认参数和强制关键字混搭时，由于默认参数的特性，当使用默认值时，我们可以不写 &#x3D; ，但是想给默认参数传值时，则一定要指明默认参数名</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, *, arg2=<span class="number">2</span>, arg3=<span class="number">3</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, arg2=<span class="number">20</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        test(<span class="number">1</span>, <span class="number">20</span>, <span class="number">30</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError <span class="keyword">as</span> t:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/13.png"></p>
<ul>
<li>以上不难看出如果定义在强制关键词参数后的默认参数想修改默认参数的值，必须要写 &#x3D;，否则就会报错</li>
</ul>
<p>默认参数和强制关键字参数混搭可以打破默认参数位置限制，但 * 号前的参数依旧要满足默认参数位限制（默认参数位置限制参考上面）</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, *, arg2=<span class="number">2</span>, arg3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, arg2=<span class="number">20</span>, arg3=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/14.png"></p>
<ul>
<li><p>以上不难看出默认参数可以写在位置参数之前了，打破了之前的限制，因为后面位置参数变为了强制关键字参数，因此不会引发二义性。但是后面的强制关键字参数依旧要使用等号，否则编译不通过。因为不满足实参传值时位置参数要在关键字参数之前</p>
<p><img src="/./images/python/method/15.png"></p>
</li>
</ul>
<h3 id="可变位置参数（又叫可变参数）"><a href="#可变位置参数（又叫可变参数）" class="headerlink" title="可变位置参数（又叫可变参数）"></a>可变位置参数（又叫可变参数）</h3><p>有时候我们不确定具体传参时某些形参需要传多少个，那么我们就引入可变位置参数</p>
<p>使用方式：在定义形参的名字前写上 *</p>
<p><code>def test(*args)</code></p>
<p>该可变位置参数通过把我们实际传递的实参用一个元组 args 来接受，这样完成可变确定的参数传值</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">*args</span>):</span><br><span class="line">    num = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(args) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;该可变位置参数没有传值&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> args:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;该可变位置参数参数的第<span class="subst">&#123;num&#125;</span>个元素是:<span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;args的值为:<span class="subst">&#123;args&#125;</span>, args的类型为:<span class="subst">&#123;<span class="built_in">type</span>(args)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    test(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, [<span class="number">40</span>])</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/16.png"></p>
<ul>
<li>以上不难看出 args 类型为 tuple 元组类型；并且可以不传实参给他，那么 args 就为空元组</li>
</ul>
<h3 id="可变位置参数的混搭"><a href="#可变位置参数的混搭" class="headerlink" title="可变位置参数的混搭"></a>可变位置参数的混搭</h3><p>很明显，实际需要和可变位置参数的混搭完成函数的功能多样性</p>
<p>可变位置参数可以和之前的参数任何一种或几种进行混搭，前提是依旧要满足他们各自的规则。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, *args, arg3=<span class="number">3</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;args&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, [], &#123;&#125;, <span class="string">&quot;&quot;</span>, <span class="number">30</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    test(<span class="number">1</span>, [], &#123;&#125;, <span class="string">&quot;&quot;</span>, arg3=<span class="number">30</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/17.png"></p>
<ul>
<li>以上不难看出可变位置参数本质上扮演者位置参数角色，如果要给之后的默认参数传值就得使用关键字参数进行传值，否则会默认把之后的参数都传入可变参数的元组里</li>
</ul>
<p>可变参数混搭位置参数如果某些位置参数在可变参数之后，那么一定要以关键字参数形式进行传参</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">*args, arg2</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;args&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, [], &#123;&#125;, arg2=<span class="number">20</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        test(<span class="number">1</span>, [], &#123;&#125;, <span class="number">20</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError <span class="keyword">as</span> t:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/18.png"></p>
<ul>
<li>以上不难看出如果不以关键字形式进行传参，那么就会报缺少关键字参数的错误</li>
</ul>
<p>可变位置参数依旧可以打破默认参数在位置参数之后的限制，但可变参数前的参数依旧要满足默认参数位限制（参考上面介绍）但是</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2=<span class="number">2</span>, *args</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;args&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, <span class="number">20</span>, [], &#123;&#125;)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/19.png"></p>
<ul>
<li><p>以上不难看出默认参数的默认值修改了。系统并没有把 20 传入元组作为 args。所以当出现打破默认参数位置限制的时，默认参数传值不能进行关键字参数进行传递，情况如下</p>
<ul>
<li><p>第一种情况是关键字参数在前对默认参数进行赋值，很明显违背位置参数要在关键字参数之前的规则</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2=<span class="number">2</span>, *args</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;args&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">1</span>, arg2=<span class="number">20</span>, [], &#123;&#125;)</span><br></pre></td></tr></table></figure>

<p>报错信息</p>
<p><img src="/./images/python/method/20.png"></p>
</li>
<li><p>第二种情况是默认参数放在了后面，但是结合上面的分析，即时关键字参数放在最后，依旧要满足位置对应关系</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2=<span class="number">2</span>, *args</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;args&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        test(<span class="number">1</span>, [], &#123;&#125;, arg2=<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError <span class="keyword">as</span> t:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure>

<p>报错信息</p>
<p><img src="/./images/python/method/21.png"></p>
<p>很明显提示 arg2 之前已经赋值了[] ,，所以重复赋值</p>
</li>
</ul>
</li>
</ul>
<p>注意可变位置参数不能和强制关键字参数进行混搭，否则编译不通过</p>
<p><img src="/./images/python/method/22.png"></p>
<h3 id="可变关键字参数"><a href="#可变关键字参数" class="headerlink" title="可变关键字参数"></a>可变关键字参数</h3><p>实际中如果我们要传入一组参数名和参数值不确定的参数时，我们可以用可变关键字参数进行定义</p>
<p>使用方式：在定义形参的名字前写上 **</p>
<p><code>def test(**kwargs)</code></p>
<p>该可变关键字参数通过把我们实际传递的实参用一个字典 kwargs 来接受，这样完成可变确定的参数传值</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">**kwargs</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;可变关键字参数是:<span class="subst">&#123;kwargs&#125;</span>, 类型是:<span class="subst">&#123;<span class="built_in">type</span>(kwargs)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    test(first=<span class="number">10</span>, second=<span class="number">20</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/23.png"></p>
<ul>
<li>以上不难看出返回的是一个实参输入的参数名-参数值得字典键值对，kwargs 类型是 dict 类型</li>
</ul>
<h3 id="可变关键字参数的混搭"><a href="#可变关键字参数的混搭" class="headerlink" title="可变关键字参数的混搭"></a>可变关键字参数的混搭</h3><p>可变关键字参数的混搭顺序，一定是在所有参数类型最后再定义，理由很简单：因为是用关键字参数进行传递，那么不能在默认参数和位置参数之前，这两者就包含了可变位置参数。特殊地依旧不能在强制关键字之前定义，因为不知道后面的关键字参数是否是传给 kwargs，还是本身</p>
<p><img src="/./images/python/method/24.png"></p>
<h3 id="强制位置参数（3-8新特性）"><a href="#强制位置参数（3-8新特性）" class="headerlink" title="强制位置参数（3.8新特性）"></a>强制位置参数（3.8新特性）</h3><p>用法 &#x2F;</p>
<p>强制位置表示在   &#x2F; 之前一定要使用位置参数，不接受使用关键字参数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2=<span class="number">2</span>, /, arg3=<span class="number">3</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test(<span class="number">10</span>, <span class="number">20</span>, arg3=<span class="number">30</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        test(arg1=<span class="number">10</span>, arg2=<span class="number">20</span>, arg3=<span class="number">30</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError <span class="keyword">as</span> t:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/25.png"></p>
<ul>
<li><p>以上不难看出如果用关键字参数给 &#x2F; 之前的参数赋值，那么会报错</p>
</li>
<li><p>强制位置参数不能在可变位置参数之后定义</p>
<p><img src="/./images/python/method/26.png"></p>
</li>
<li><p>强制位置参数不能在可变关键字参数之后定义</p>
<p><img src="/./images/python/method/27.png"></p>
</li>
<li><p>强制位置参数很明显应该放在强制关键字参数之前定义，否则引发矛盾</p>
<p><img src="/./images/python/method/28.png"></p>
</li>
</ul>
<h3 id="解包（开包）"><a href="#解包（开包）" class="headerlink" title="解包（开包）"></a>解包（开包）</h3><p>python 可以通过 * 对列表或元组进行解包，通过 ** 对字典进行解包</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    list1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    tuple1 = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    dict1 = &#123;<span class="string">&quot;first&quot;</span>: <span class="number">1</span>, <span class="string">&quot;second&quot;</span>: <span class="number">2</span>, <span class="string">&quot;third&quot;</span>: <span class="number">3</span>&#125;</span><br><span class="line">    <span class="built_in">print</span>(*list1)</span><br><span class="line">    <span class="built_in">print</span>(*tuple1)</span><br><span class="line">    <span class="built_in">print</span>(*dict1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test() </span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/29.png"></p>
<ul>
<li>通过以上发现，解包无非是对序列进行进行遍历。注意 * 号对字典解包是取它的 keys</li>
</ul>
<h3 id="解包的应用"><a href="#解包的应用" class="headerlink" title="解包的应用"></a>解包的应用</h3><p>此应用于传参中</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">arg1, arg2, arg3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第一个参数是:<span class="subst">&#123;arg1&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第二个参数是:<span class="subst">&#123;arg2&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第三个参数是:<span class="subst">&#123;arg3&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    args1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    args2 = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    test(*args1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    test(*args2)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/30.png"></p>
<ul>
<li>这样传参可以瞬间传递自动遍历</li>
</ul>
<p>通过解包可以使得可变位置参数和可变关键字参数传参变得灵活容易起来</p>
<ul>
<li><p>可变位置参数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">*args</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解包参数是:<span class="subst">&#123;args&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(*args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    args1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    args2 = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    test(*args1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;**********************&quot;</span>)</span><br><span class="line">    test(*args2)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/31.png"></p>
</li>
<li><p>可变关键字参数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">**kwargs</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解包参数是:<span class="subst">&#123;kwargs&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    args = &#123;<span class="string">&quot;first&quot;</span>: <span class="number">1</span>, <span class="string">&quot;second&quot;</span>: <span class="number">2</span>&#125;</span><br><span class="line">    test(**args)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/32.png"></p>
</li>
</ul>
<h1 id="函数的返回值"><a href="#函数的返回值" class="headerlink" title="函数的返回值"></a>函数的返回值</h1><p>python 是弱类型语言，对返回值没有定性的要求，可以返回 None，可以不写 return 语句默认返回 None，可以有多个返回值，但是要在一个 return 语句中实现，并且这多个返回值以元组形式返回</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test_not_return</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_return_None</span>():</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_return_single</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_return_diff</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>, <span class="number">2.</span>, <span class="string">&quot;&quot;</span>, [], (), &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(test_not_return())</span><br><span class="line">    <span class="built_in">print</span>(test_return_None())</span><br><span class="line">    <span class="built_in">print</span>(test_return_single())</span><br><span class="line">    <span class="built_in">print</span>(test_return_diff())</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/33.png"></p>
<ul>
<li>以上可以看到 方法可以没有返回值，可以没有 return 语句，可以有多个不同类型返回值，多个返回值确实以元组形式返回</li>
</ul>
<h1 id="函数的类型"><a href="#函数的类型" class="headerlink" title="函数的类型"></a>函数的类型</h1><h2 id="普通函数"><a href="#普通函数" class="headerlink" title="普通函数"></a>普通函数</h2><p>普通函数属于自定义函数，满足函数规则即可</p>
<h2 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h2><p>python 支持匿名函数，即函数名未知地定义，使用 lambda 表达式来定义</p>
<h3 id="匿名函数定义方式"><a href="#匿名函数定义方式" class="headerlink" title="匿名函数定义方式"></a>匿名函数定义方式</h3><p>lambda [arg1 [,arg2, … argN]] : expression</p>
<ul>
<li>以上可以看出 lambda 表达式参数可以多个，但是只能有一个返回表达式</li>
</ul>
<p>一般 lambda 表达式用于简单的方法场合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test = lambda x, y: x ** y</span><br><span class="line">print(test.__class__)</span><br><span class="line">print(test)</span><br><span class="line">print(test(3, 2))</span><br></pre></td></tr></table></figure>

<ul>
<li>以上发现 lambda 表达式就是一个 function （python中具体为 types.FunctionType）类的对象</li>
</ul>
<h2 id="内部函数"><a href="#内部函数" class="headerlink" title="内部函数"></a>内部函数</h2><p>一般来说，函数内部也可以定义新的函数。那么我们称这个函数为内部函数或局部函数</p>
<p>内部函数的本质就是局部变量(函数就是一个变量)。在函数外部不可以直接调用（闭包机制可以打破）。内部函数在函数内部调用</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test1</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test2</span>():</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">test3</span>():</span><br><span class="line">            <span class="built_in">print</span>(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        test3()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test3</span>():</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">    test2()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test1()</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/34.png"></p>
<ul>
<li>以上我们可以看出内部函数可以嵌套，因为本质是局部变量我们依旧可以在外部定义一个和内部重名的函数</li>
</ul>
<h2 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h2><p>高阶函数本质也是普通函数，只不过 python 强调一切皆为对象，那么函数本身也是一个对象。怎么证明呢</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(test))</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/35.png"></p>
<ul>
<li><p>这时会发现 test 为function类的实例对象。但是查阅资料知道 function 类引用被 del 了，只不过被一个类沿用，那就是 types 模块的 FunctionType 类</p>
<p><img src="/./images/python/method/36.png"></p>
<p>那根据参数传递的本质就是传递一个个对象，那么函数依旧可以作为对象传入方法中，其中接收函数参数的方法就被称为高阶函数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    result = <span class="built_in">filter</span>(test, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(result))</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/37.png"></p>
<p>从上面可以分析出，<code>filter()</code>内置函数把 test 作为参数传入进了方法里</p>
</li>
</ul>
<h2 id="偏函数"><a href="#偏函数" class="headerlink" title="偏函数"></a>偏函数</h2><h3 id="偏函数使用情形"><a href="#偏函数使用情形" class="headerlink" title="偏函数使用情形"></a>偏函数使用情形</h3><p>函数在执行时，要带上所有必要的参数进行调用。但是，有时参数可以在函数被调用之前提前获知。这种情况下，一个函数有一个或多个参数预先就能用上，以便函数能用更少的参数进行调用。</p>
<h3 id="偏函数使用方法："><a href="#偏函数使用方法：" class="headerlink" title="偏函数使用方法："></a>偏函数使用方法：</h3><p>要用到 functools 模块的 partial 方法</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> partial</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> x &gt; y:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    result = partial(test, <span class="number">5</span>)</span><br><span class="line">    <span class="built_in">print</span>(result(<span class="number">100</span>))</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/38.png"></p>
<ul>
<li>很明显看出，我们已知 x &#x3D; 5，的前提下，把偏函数作为一个新函数进行传参就可以得到结果。从上面看出偏函数本质也是高阶函数</li>
</ul>
<h2 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h2><p>由于讲了函数可以作为参数传入，那么回调函数的作用就是把自身作为参数传入到一个新函数中，利用新函数的其他参数作为自身的参数进行操作</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test1</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">callback</span>(<span class="params">function_name, b</span>):</span><br><span class="line">    function_name(b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    callback(test1, <span class="string">&quot;我是回调函数&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/39.png"></p>
<h3 id="回调函数的异步处理"><a href="#回调函数的异步处理" class="headerlink" title="回调函数的异步处理"></a>回调函数的异步处理</h3><p><code>pass</code></p>
<h3 id="回调函数的本质原因"><a href="#回调函数的本质原因" class="headerlink" title="回调函数的本质原因"></a>回调函数的本质原因</h3><p>回调函数之所以能这么使用是因为所有 函数都是 types.FunctionType 类的实例对象，而 python 提供了一个魔法方法 <code>__call__()</code>，这样可以使得他的对象都可以用对象名(args)进行使用。前提是一定要显示地写出来。</p>
<p><img src="/./images/python/method/40.png"></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, name, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span>(name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test = A()</span><br><span class="line">    test(<span class="string">&quot;这就是函数带括号的底层原理&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/41.png"></p>
<ul>
<li>以上不难看出我们的 test 对象竟然也可以写成 <code>test()</code>了，因为我们在 A 类里重写了 <code>__call__()</code> 方法，使得 test 对象可以作为函数名使用，同理这适用于回调函数语法。所以本质回调函数依旧是一种高阶函数</li>
</ul>
<h2 id="函数的闭包"><a href="#函数的闭包" class="headerlink" title="函数的闭包"></a>函数的闭包</h2><p>python 如果我们想对一个函数本身进行操作，那么那个操作本身也是函数。所以 python 提供函数内嵌套函数。通过这种方法我们能很好地处理不同函数的类似问题。通过闭包我们能在外部使用函数内的局部代码块了。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">outer</span>(<span class="params">a</span>):</span><br><span class="line">    a = a + <span class="number">1</span>    </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">id</span>(a))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">b</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">id</span>(a))</span><br><span class="line">        <span class="built_in">print</span>(b + a)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">inner1 = outer(a=<span class="number">7</span>)</span><br><span class="line">inner1(b=<span class="number">5</span>)</span><br><span class="line">inner2 = outer(a=<span class="number">8</span>)</span><br><span class="line">inner2(b=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/42.png"></p>
<ul>
<li><p>由上面可以看到闭包机制一个特点是对每一次的局部变量的值可以保留在内层函数里。具体请参考</p>
<a href="/2022/12/10/python/python%20%E5%86%85%E5%AD%98%E8%AF%A6%E8%A7%A3/" title="python 内存详解">python 内存详解</a></li>
</ul>
<h2 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h2><p>python 提供的一种语法构造，由于之前分析的 闭包机制，那么我们想把一个函数对象当做参数传入到闭包机制中，那么 python 提供装饰器语法这样不用每次把原函数指向闭包后的新函数。这个闭包函数我们就称之为装饰器</p>
<h3 id="装饰器的使用方法"><a href="#装饰器的使用方法" class="headerlink" title="装饰器的使用方法"></a>装饰器的使用方法</h3><p>本质是将所装饰的函数对象作为参数传输到装饰器函数中去。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_runtime</span>(<span class="params">method</span>):</span><br><span class="line">    start = time.time()</span><br><span class="line">    method()</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(end - start)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_game</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200000</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;游戏打完了&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shopping</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">80000</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;东西打完了&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    calculate_runtime(play_game)</span><br><span class="line">    calculate_runtime(shopping)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/43.png"></p>
<p>很明显这种方式处理函数会有局限性，因为我们只想对函数功能进行添加，当自己运行函数的时候就可以</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_runtime</span>(<span class="params">method</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>():</span><br><span class="line">        start = time.time()</span><br><span class="line">        method()</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="built_in">print</span>(end - start)</span><br><span class="line">        <span class="keyword">return</span> run</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_game</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200000</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;游戏打完了&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shopping</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">80000</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;东西打完了&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">play_game = calculate_runtime(play_game)</span><br><span class="line">play_game()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">50</span>)</span><br><span class="line">shopping = calculate_runtime(shopping)</span><br><span class="line">shopping()</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p>​	<img src="/./images/python/method/44.png"></p>
<h3 id="装饰器的语法糖"><a href="#装饰器的语法糖" class="headerlink" title="装饰器的语法糖"></a>装饰器的语法糖</h3><p>这种方式比上一种好的是，我能直接运行原来的函数使得功能性不一样了，但是每次都用 method &#x3D; function(method) 太麻烦了。在定义函数体上方用 <code>@装饰器名</code>去装饰所定义的函数，我们称之为 <em>语法糖</em>。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_runtime</span>(<span class="params">method</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>():</span><br><span class="line">        start = time.time()</span><br><span class="line">        method()</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="built_in">print</span>(end - start)</span><br><span class="line">    <span class="keyword">return</span> run</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@calculate_runtime</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_game</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200000</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;游戏打完了&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@calculate_runtime</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shopping</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">80000</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;东西打完了&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    play_game()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    shopping()</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/45.png"></p>
<h3 id="装饰器内部的参数设置"><a href="#装饰器内部的参数设置" class="headerlink" title="装饰器内部的参数设置"></a>装饰器内部的参数设置</h3><p>以上例子有大量的局限性：被装饰的方法没有参数。如果被装饰的方法有参数，并且参数不唯一且可变呢。那么我们直接使用我们的可变位置参数和可变强制参数来传值</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_runtime</span>(<span class="params">method</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        start = time.time()</span><br><span class="line">        method(*args, **kwargs)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="built_in">print</span>(end - start)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> run</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@calculate_runtime</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_game</span>(<span class="params">game, times=<span class="number">200000</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;游戏<span class="subst">&#123;game&#125;</span>打完了&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    play_game(<span class="string">&quot;csgo&quot;</span>, <span class="number">100000</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/46.png"></p>
<h3 id="有参装饰器"><a href="#有参装饰器" class="headerlink" title="有参装饰器"></a>有参装饰器</h3><p>我们发现装饰器虽好，但是我们需要的功能比较多的时候，需要用到外部其他变量的时候，其中内部 warpper() 和外部的 outer() 方法都不能添加其他额外的参数，因为写法已经固定了。所以我们可以通过外层嵌套另外一层函数来实现</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">argument_</span>(<span class="params">sleep_time</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">calculate_runtime</span>(<span class="params">method</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">            start = time.time()</span><br><span class="line">            method(*args, **kwargs)</span><br><span class="line">            time.sleep(sleep_time)</span><br><span class="line">            end = time.time()</span><br><span class="line">            <span class="built_in">print</span>(end - start)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> run</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> calculate_runtime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@argument_(<span class="params"><span class="number">2</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_game</span>(<span class="params">game, times=<span class="number">200000</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;游戏<span class="subst">&#123;game&#125;</span>打完了&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    play_game(<span class="string">&quot;csgo&quot;</span>, <span class="number">100000</span>)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/47.png"></p>
<ul>
<li>以上我们不难看出通过这种方法成功实现了再次操控被装饰的函数</li>
</ul>
<h3 id="伪装原函数"><a href="#伪装原函数" class="headerlink" title="伪装原函数"></a>伪装原函数</h3><p>我们要想达到对原函数的完全装饰而让外部不察觉出来，我们可以通过伪装原函数进行实现。</p>
<p>第一个例子如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_runtime</span>(<span class="params">method</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        start = time.time()</span><br><span class="line">        method(*args, **kwargs)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="built_in">print</span>(end - start)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> run</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@calculate_runtime</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_game</span>(<span class="params">game, times=<span class="number">200000</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;游戏<span class="subst">&#123;game&#125;</span>打完了&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;该去吃饭了&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    result = play_game(<span class="string">&quot;csgo&quot;</span>, <span class="number">100000</span>)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/48.png"></p>
<ul>
<li>很明显，该函数没有返回值，这样没办法达到不改变其函数的内部性质</li>
</ul>
<p>第二个例子</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_runtime</span>(<span class="params">method</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        start = time.time()</span><br><span class="line">        method(*args, **kwargs)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="built_in">print</span>(end - start)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> run</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@calculate_runtime</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_game</span>(<span class="params">game, times=<span class="number">200000</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;游戏<span class="subst">&#123;game&#125;</span>打完了&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(play_game.__name__)</span><br><span class="line">    <span class="built_in">print</span>(play_game.__str__())</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/49.png"></p>
<ul>
<li>很明显，由于装饰器本质是闭包，那么使用装饰器后，函数的引用指向了内部的方法，所以很多函数的属性值会跟着变化。</li>
</ul>
<p>以上例子说明了我们没有真正地实现不改变函数的内部属性来实现额外的功能。我们可以通过调用 functools 的 warps() 装饰器来装饰内部的函数使得原来函数的属性不改变，原理就是提前在内部拷贝一份原来函数的所有属性值。函数的返回值我们直接用一个变量来接收并返回</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_runtime</span>(<span class="params">method</span>):</span><br><span class="line"><span class="meta">    @functools.wraps(<span class="params">method</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        start = time.time()</span><br><span class="line">        result = method(*args, **kwargs)</span><br><span class="line">        end = time.time()</span><br><span class="line">        <span class="built_in">print</span>(end - start)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> run</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@calculate_runtime</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_game</span>(<span class="params">game, times=<span class="number">200000</span></span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;游戏<span class="subst">&#123;game&#125;</span>打完了&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;该吃饭了&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    result = play_game(<span class="string">&quot;cf&quot;</span>, <span class="number">30000</span>)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="built_in">print</span>(play_game.__name__)</span><br><span class="line">    <span class="built_in">print</span>(play_game.__str__())</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/50.png"></p>
<h3 id="装饰器模板"><a href="#装饰器模板" class="headerlink" title="装饰器模板"></a>装饰器模板</h3><p>我们发现装饰器有共同的结构，这样就形成了一个装饰器模板</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">outer_</span>(<span class="params">*arg, **kwarg</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">outer</span>(<span class="params">functions</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">warpper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">            result = functions(*args, **kwargs)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        <span class="keyword">return</span> warpper</span><br><span class="line">    <span class="keyword">return</span> outer</span><br></pre></td></tr></table></figure>

<p>以上就构成了一个有参装饰器的模板了</p>
<h3 id="多个装饰器装饰一个函数"><a href="#多个装饰器装饰一个函数" class="headerlink" title="多个装饰器装饰一个函数"></a>多个装饰器装饰一个函数</h3><p>当多个装饰器装饰一个函数那么执行顺序是什么呢</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">outer_1</span>(<span class="params">*arg, **kwarg</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">outer</span>(<span class="params">functions</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">warpper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;这是 outer_1 之前&quot;</span>)</span><br><span class="line">            result = functions(*args, **kwargs)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;这是 outer_1 之后&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> warpper</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> outer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">outer_2</span>(<span class="params">*arg, **kwarg</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">outer</span>(<span class="params">functions</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">warpper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;这是 outer_2 之前&quot;</span>)</span><br><span class="line">            result = functions(*args, **kwargs)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;这是 outer_2 之后&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> warpper</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> outer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@outer_2()</span></span><br><span class="line"><span class="meta">@outer_1()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test()</span><br></pre></td></tr></table></figure>

<p>返回</p>
<p><img src="/./images/python/method/51.png"></p>
<ul>
<li>以上我们不难看出装饰顺序是先用最靠近函数的 outer_1() 装饰器然后是 outer_2() 装饰器</li>
<li>通过栈的压栈和出栈可以解释以上返回值<ol>
<li>调用 test() 本质是执行 <code>outer_2.outer(outer_1.outer(test))</code></li>
<li>压栈原理，程序执行到 <code>outer_2.outer()</code>后会先执行 <code>print(&quot;这是 outer_2 之前&quot;)</code></li>
<li>然后碰到 <code>funtions</code>此时传入 <code>outer_1.outer</code> 进行执行 <code>print(&quot;这是 outer_1 之前&quot;)</code></li>
<li>接着执行原函数</li>
<li>然后执行接着第 3 步骤的<code>print(&quot;这是 outer_1 之后&quot;)</code></li>
<li>等 <code>outer_1.outer()</code>执行完毕就会得到 result 的返回值。注意这里的 <code>result</code> 并不是直观意义上的 <code>outer_1.outer</code> 这个引用，而是多重调用装饰器，内部优化成 <code>outer_1.outer (test)()</code>，这样 <code>outer2.outer</code> 里的接收的返回值其实本质就是 <code>outer1.outer</code> 里的 result 的值</li>
<li>最后再执行 outer_2 的<code>print(&quot;这是 outer_2 之后&quot;)</code></li>
</ol>
</li>
</ul>
<h3 id="装饰器的本质"><a href="#装饰器的本质" class="headerlink" title="装饰器的本质"></a>装饰器的本质</h3><p>以上可以看到装饰器本质就是闭包，只不过参数变为了被装饰的函数。</p>

        </article>
        <section class="post-near">
            <ul>
                
                    <li>上一篇: <a href="/2022/12/10/python/python%20%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/">python 迭代器和生成器</a></li>
                
                
                    <li>下一篇: <a href="/2022/12/08/python/python%20%E9%A9%BB%E7%95%99%E6%9C%BA%E5%88%B6/">python 驻留机制</a></li>
                
            </ul>
        </section>
        
            <section class="post-tags">
            <a class="-none-link" href="/tags/python/" rel="tag">python</a><a class="-none-link" href="/tags/%E5%87%BD%E6%95%B0/" rel="tag">函数</a><a class="-none-link" href="/tags/%E6%96%B9%E6%B3%95/" rel="tag">方法</a>
            </section>
        
    
        <section class="post-author">
        
            <figure class="author-avatar">
                <img src="/images/images/myhead.png" alt="Junliangl" />
            </figure>
        
            <div class="author-info">
                <h4>Junliangl</h4>
                <p style="color: #e6cfe6">我是一个软件测试工程师，感兴趣可以查看
				    <a target="_blank" rel="noopener" href="https://github.com/junliangl">我的github</a>
					 本站采用
					<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>
					 协议，转载请注明来源，谢谢!
				</p>
            </div>
        </section>
    
    </div>
</main>

    <footer>
    <div class="buttons">
        <a class="to-top" href="#"></a>
    </div>
    <div class="wrap min">
        <section class="widget">
            <div class="row">
                <div class="col-m-4">
                    <h3 class="title-recent">最新文章：</h3>
                    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/12/10/python/python%20%E7%B1%BB%E8%AF%A6%E8%A7%A3/">python 类详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/10/python/python%20%E5%86%85%E5%AD%98%E8%AF%A6%E8%A7%A3/">python 内存详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/10/python/python%20%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/">python 迭代器和生成器</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/08/python/python%20%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/">python 函数详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/08/python/python%20%E9%A9%BB%E7%95%99%E6%9C%BA%E5%88%B6/">python 驻留机制</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/08/python/python%20%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6%20break%20%E5%92%8C%20continue/">python 循环控制 break 和 continue</a></li></ul>
                </div>
                <div class="col-m-4">
                    <h3 class="title-date">历史：</h3>
                    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li></ul>
                </div>
                <div class="col-m-4">
                    <h3 class="title-tags">标签云：</h3>
                    <a href="/tags/continer/" style="font-size: 1020;">continer</a> <a href="/tags/pytest/" style="font-size: 1020;">pytest</a> <a href="/tags/python/" style="font-size: 2020;">python</a> <a href="/tags/%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6/" style="font-size: 1020;">内存机制</a> <a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 1020;">函数</a> <a href="/tags/%E5%8F%98%E9%87%8F/" style="font-size: 1020;">变量</a> <a href="/tags/%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 1020;">基本数据类型</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 1020;">字符串</a> <a href="/tags/%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/" style="font-size: 1520;">常用方法</a> <a href="/tags/%E5%BC%80%E5%8F%91%E6%A8%A1%E5%9E%8B/" style="font-size: 1020;">开发模型</a> <a href="/tags/%E5%BE%AA%E7%8E%AF/" style="font-size: 1020;">循环</a> <a href="/tags/%E6%96%B9%E6%B3%95/" style="font-size: 1020;">方法</a> <a href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" style="font-size: 1520;">测试工具</a> <a href="/tags/%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/" style="font-size: 1020;">测试用例</a> <a href="/tags/%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E8%AE%BE%E8%AE%A1/" style="font-size: 1020;">测试用例设计</a> <a href="/tags/%E7%B1%BB/" style="font-size: 1020;">类</a> <a href="/tags/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/" style="font-size: 1020;">虚拟环境</a> <a href="/tags/%E8%B4%A8%E9%87%8F%E6%A8%A1%E5%9E%8B/" style="font-size: 1020;">质量模型</a> <a href="/tags/%E8%BF%90%E7%AE%97%E7%AC%A6/" style="font-size: 1020;">运算符</a> <a href="/tags/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/" style="font-size: 1020;">迭代器和生成器</a>
                </div>
            </div>
        </section>
        <section class="sub-footer">
            <p>© 2022 <a href="/">onepiece</a>. All Rights Reserved. Theme By <a href="https://github.com/Dreamer-Paul/Hingle" target="_blank" rel="nofollow">Hingle</a>.</p>
        </section>
    </div>
</footer>


<script src="/static/kico.js"></script>
<script src="/static/hingle.js"></script>


<script>var hingle = new Paul_Hingle({"copyright":true,"night":true});</script>

  </body>
</html>
